<html lang="ru" data-theme="dark"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏">
<style>
:root{
  --bg:#0f1115; --fg:#e9eef5; --muted:#9aa5b1; --card:#171b25;
  --primary:#6aa7ff; --good:#41d27a; --warn:#ffcc66; --accent:#ff7ad9;
  --stroke:rgba(255,255,255,.10);
}
@media (prefers-color-scheme: light){
  :root{
    --bg:#f5f7fb; --fg:#0f172a; --muted:#475569; --card:#ffffff;
    --primary:#2e5cff; --good:#22c55e; --warn:#f59e0b; --accent:#db2777;
    --stroke:rgba(0,0,0,.08);
  }
}
:root[data-theme='light']{
  --bg:#f5f7fb; --fg:#0f172a; --muted:#475569; --card:#ffffff;
  --primary:#2e5cff; --good:#22c55e; --warn:#f59e0b; --accent:#db2777;
  --stroke:rgba(0,0,0,.08);
}
:root[data-theme='dark']{
  --bg:#0f1115; --fg:#e9eef5; --muted:#bcc4cf; --card:#171b25;
  --primary:#84b6ff; --good:#44e08a; --warn:#ffd27a; --accent:#ff99e3;
  --stroke:rgba(255,255,255,.14);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro",Arial,sans-serif;color:var(--fg);background:
  radial-gradient(1200px 800px at 10% -10%, rgba(255,122,217,.25), transparent 40%),
  radial-gradient(900px 700px at 110% 0%, rgba(106,167,255,.20), transparent 40%),
  radial-gradient(1200px 900px at 50% 120%, rgba(65,210,122,.15), transparent 40%),
  var(--bg)}
.container{padding:calc(env(safe-area-inset-top) + 14px) 14px 14px}
.row{display:grid;grid-template-columns:1fr;gap:10px}
.header{display:flex;align-items:center;gap:8px;margin-bottom:10px}.spacer{flex:1}
.iconbtn{appearance:none;border:1px solid var(--stroke);background:var(--card);color:var(--fg);border-radius:10px;padding:6px 8px;cursor:pointer;transition:transform .05s ease, background .2s ease}
.iconbtn:active{transform:scale(0.96);background:color-mix(in oklab, var(--primary) 20%, var(--card) 80%)}.iconbtn.on{background:color-mix(in oklab, var(--accent) 25%, var(--card) 75%)}
.btn{display:block;width:100%;margin:6px 0;padding:12px 14px;border:1px solid var(--stroke);background:linear-gradient(180deg, var(--card), color-mix(in oklab, var(--card) 60%, black 20%));color:var(--fg);border-radius:12px;font-size:16px;text-align:center;cursor:pointer}
.btn.primary{background:linear-gradient(180deg, color-mix(in oklab, var(--primary) 65%, white 15%), var(--primary));border:none;color:#fff}.btn.good{background:linear-gradient(180deg, color-mix(in oklab, var(--good) 65%, white 10%), var(--good));border:none;color:#001b0c}
.screen{display:none}.screen.active{display:block}.card{background:var(--card);border:1px solid var(--stroke);border-radius:14px;padding:12px;box-shadow:0 8px 30px rgba(0,0,0,.2)}
.ex{border:1px dashed var(--stroke);border-radius:12px;padding:10px;margin-bottom:8px}
.ex h3{font-size:17px;margin:0 0 2px;line-height:1.2}
.meta{color:var(--muted);font-size:14px;display:flex;gap:12px;flex-wrap:wrap;margin-bottom:4px}
.extra{color:#ff7a7a;font-size:13px;margin:2px 0 6px}
.label{font-size:12px;color:#003b89;background:color-mix(in oklab, var(--primary) 20%, white 80%);border:1px solid color-mix(in oklab, var(--primary) 60%, black 10%);padding:4px 8px;border-radius:999px;display:inline-block;margin-bottom:8px}
.pager{display:flex;align-items:center;justify-content:space-between;margin-top:10px;gap:10px}
.pill{color:var(--fg);background:rgba(255,255,255,.18);border:1px solid var(--stroke);border-radius:999px;padding:4px 10px;font-size:12px}
:root[data-theme='light'] .pill{background:rgba(0,0,0,.06)}
.dot{width:7px;height:7px;border-radius:8px;background:var(--good);display:inline-block;margin-right:6px}
.sets{display:flex;gap:6px;flex-wrap:nowrap;margin-top:6px;overflow-x:auto}
.sets .set{display:flex;align-items:center;gap:6px;padding:4px 6px;border:1px solid var(--stroke);border-radius:10px;background:rgba(255,255,255,.08);flex:0 0 auto;white-space:nowrap;color:var(--fg)}
:root[data-theme='light'] .sets .set{background:rgba(0,0,0,.04)}
.sets .set input{width:18px;height:18px;accent-color:var(--good)}
.weight{margin-top:6px;display:flex;align-items:center;gap:8px}
.weight input{flex:0 0 100px;padding:8px;border:1px solid var(--stroke);border-radius:10px;background:transparent;color:var(--fg);font-size:18px}
.list{display:grid;gap:8px}
.item{padding:8px;border:1px solid var(--stroke);border-radius:10px;background:var(--card);font-size:14px;display:flex;align-items:center;justify-content:space-between;gap:8px}
.item button{border:1px solid var(--stroke);background:transparent;color:var(--fg);border-radius:8px;padding:4px 8px;cursor:pointer}
.chart{width:100%;height:220px;background:color-mix(in oklab, var(--primary) 8%, white 92%);border:1px solid var(--stroke);border-radius:12px}
</style>
</head>
<body>
  <div class="container">
    <section id="home" class="screen active">
      <div class="header">
        <h1>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h1>
        <span class="spacer"></span>
        <button id="btnTheme" class="iconbtn" title="–¢–µ–º–∞">üåô</button>
        <button id="btnHistory" class="iconbtn" title="–ü—Ä–æ–≥—Ä–µ—Å—Å">üìà</button>
      </div>
      <div class="row">
        <button id="btnPavel" class="btn primary">–ü–∞–≤–µ–ª</button>
        <button id="btnYulia" class="btn good">–Æ–ª–∏—è</button>
      </div>
    </section>

    <section id="person" class="screen">
      <div class="header">
        <button id="backHome" class="iconbtn">‚Äπ –ù–∞–∑–∞–¥</button>
        <h2 id="personTitle">–Æ–ª–∏—è</h2>
        <span class="spacer"></span>
      </div>
      <div class="row">
        <button id="day1" class="btn">–î–µ–Ω—å 1</button>
        <button id="day2" class="btn">–î–µ–Ω—å 2</button>
        <button id="day3" class="btn">–î–µ–Ω—å 3</button>
      </div>
    </section>

    <section id="day" class="screen">
      <div class="header">
        <button id="backPerson" class="iconbtn">‚Äπ –ù–∞–∑–∞–¥</button>
        <h2 id="dayTitle">–î–µ–Ω—å 2</h2>
        <span class="spacer"></span>
        <span class="pill" id="timeLeftPill">‚âà 1:30 –æ—Å—Ç–∞–ª–æ—Å—å</span>
        <button id="btnResetDay" class="iconbtn" title="–°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–Ω—è">‚ôªÔ∏è</button>
        <button id="btnFinish" class="iconbtn" title="–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É">‚úÖ</button>
      </div>

      <div class="card" id="pageCard">
        <div id="dayLabel" class="label">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1</div>
        <div id="pages"><div class="ex"><h3><span class="dot"></span>–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è</h3><div class="meta"><div>–ü–æ–¥—Ö–æ–¥—ã: <b>3</b></div><div>–ü–æ–≤—Ç–æ—Ä—ã: <b>20/20</b></div><div>–ì—Ä—É–ø–ø–∞: <b>–ü—Ä–µ—Å—Å</b></div></div><div class="sets"><label class="set"><input type="checkbox" data-k="s|yulia|2|5|0|1"> –°–µ—Ç 1</label><label class="set"><input type="checkbox" data-k="s|yulia|2|5|0|2"> –°–µ—Ç 2</label><label class="set"><input type="checkbox" data-k="s|yulia|2|5|0|3"> –°–µ—Ç 3</label></div></div></div>
        <div class="pager">
          <button class="btn ghost" id="prevBtn">‚óÄÔ∏é –ù–∞–∑–∞–¥</button>
          <div class="pill" id="counter">6 / 7</div>
          <button class="btn ghost" id="nextBtn">–í–ø–µ—Ä—ë–¥ ‚ñ∂Ô∏é</button>
        </div>
      </div>
    </section>

    <section id="history" class="screen">
      <div class="header">
        <button id="backHome2" class="iconbtn">‚Äπ –ù–∞–∑–∞–¥</button>
        <h2>–ü—Ä–æ–≥—Ä–µ—Å—Å</h2>
      </div>
      <div class="card">
        <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
        <div id="historyList" class="list"><div class="item"><span>28.09.2025 ¬∑ –Æ–ª–∏—è ¬∑ –î–µ–Ω—å 2 ‚Äî –ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ ‚Äî 1/1; –§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∑–∞—à–∞–≥–∏–≤–∞–Ω–∏—è ‚Äî 4/4 ¬∑ 30 –∫–≥; –ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è ‚Äî 4/4 ‚Ä¶</span><button data-index="0">–£–¥–∞–ª–∏—Ç—å</button></div><div class="item"><span>28.09.2025 ¬∑ –Æ–ª–∏—è ¬∑ –î–µ–Ω—å 1 ‚Äî –ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ ‚Äî 1/1; –ñ–∏–º –Ω–æ–≥–∞–º–∏ ‚Äî 4/4 ¬∑ 20 –∫–≥; –†–∞–∑–≤–µ–¥–µ–Ω–∏—è –±—ë–¥–µ—Ä ‚Äî 4/4 ‚Ä¶</span><button data-index="1">–£–¥–∞–ª–∏—Ç—å</button></div><div class="item"><span>28.09.2025 ¬∑ –Æ–ª–∏—è ¬∑ –î–µ–Ω—å 1 ‚Äî –ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ ‚Äî 1/1; –ñ–∏–º –Ω–æ–≥–∞–º–∏ ‚Äî 4/4; –†–∞–∑–≤–µ–¥–µ–Ω–∏—è –±—ë–¥–µ—Ä ‚Äî 4/4 ‚Ä¶</span><button data-index="2">–£–¥–∞–ª–∏—Ç—å</button></div><div class="item"><span>28.09.2025 ¬∑ –Æ–ª–∏—è ¬∑ –î–µ–Ω—å 1 ‚Äî –ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞ ‚Äî 0/1; –ñ–∏–º –Ω–æ–≥–∞–º–∏ ‚Äî 0/4; –†–∞–∑–≤–µ–¥–µ–Ω–∏—è –±—ë–¥–µ—Ä ‚Äî 0/4 ‚Ä¶</span><button data-index="3">–£–¥–∞–ª–∏—Ç—å</button></div></div>
      </div>
      <div class="card" style="margin-top:10px">
        <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—é</h3>
        <select id="exerciseSelect" class="btn ghost"><option value="–ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è">–ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è</option><option value="–ñ–∏–º –Ω–æ–≥–∞–º–∏">–ñ–∏–º –Ω–æ–≥–∞–º–∏</option><option value="–ú—ë—Ä—Ç–≤–∞—è —Ç—è–≥–∞ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ">–ú—ë—Ä—Ç–≤–∞—è —Ç—è–≥–∞ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ</option><option value="–ü–µ–∫-–¥–µ–∫">–ü–µ–∫-–¥–µ–∫</option><option value="–¢—è–≥–∞ –∫ –ø–æ—è—Å—É —Å—Ç–æ—è">–¢—è–≥–∞ –∫ –ø–æ—è—Å—É —Å—Ç–æ—è</option><option value="–§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∑–∞—à–∞–≥–∏–≤–∞–Ω–∏—è">–§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∑–∞—à–∞–≥–∏–≤–∞–Ω–∏—è</option></select>
        <canvas id="chart" class="chart" width="1116" height="654"></canvas>
      </div>
    </section>
  </div>

<script>
const programs = {"yulia": {"1": [{"ex": [{"title": "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "sets": "1", "reps": "10:00", "group": "–ö–∞—Ä–¥–∏–æ", "details": "–†–∞–∑–º–∏–Ω–∫–∞"}]}, {"ex": [{"title": "–ñ–∏–º –Ω–æ–≥–∞–º–∏", "sets": "4", "reps": "15‚Äì20", "group": "–ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å—ã, —è–≥–æ–¥–∏—á–Ω—ã–µ", "extra": "–ö–æ–ª–µ–Ω–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—ã, —É–ø–æ—Ä –≤ –ø—è—Ç–∫–∏"}, {"title": "–†–∞–∑–≤–µ–¥–µ–Ω–∏—è –±—ë–¥–µ—Ä", "sets": "4", "reps": "15‚Äì20", "group": "–°—Ä–µ–¥–Ω—è—è –∏ –º–∞–ª–∞—è —è–≥–æ–¥–∏—á–Ω—ã–µ", "extra": "–ü–æ—è—Å–Ω–∏—Ü–∞ –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞, –º–æ–∂–Ω–æ —á—É—Ç—å –æ–∫—Ä—É–≥–ª–∏—Ç—å—Å—è"}]}, {"ex": [{"title": "–°–≥–∏–±–∞–Ω–∏—è –≥–æ–ª–µ–Ω–∏", "sets": "4", "reps": "20/20", "group": "–ë–∏—Ü–µ–ø—Å –±–µ–¥—Ä–∞, –∏–∫—Ä—ã", "extra": "–ü–æ—è—Å–Ω–∏—Ü–∞ –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞, –º–æ–∂–Ω–æ —á—É—Ç—å –æ–∫—Ä—É–≥–ª–∏—Ç—å—Å—è"}, {"title": "–•–∏–ø—á–∏", "sets": "4", "reps": "20/20", "group": "–Ø–≥–æ–¥–∏—á–Ω—ã–µ, —Å–ø–∏–Ω–∞", "extra": "–ë–µ—Ä—ë–º—Å—è –∫—Ä–µ—Å—Ç-–Ω–∞–∫—Ä–µ—Å—Ç, –ø—Ä–∞–≤–∞—è –Ω–æ–≥–∞ —Å–ø–µ—Ä–µ–¥–∏, —Ä—É–∫–æ—è—Ç—å –≤ –ª–µ–≤–æ–π —Ä—É–∫–µ"}]}, {"ex": [{"title": "–¢—è–≥–∞ –∫ –≥—Ä—É–¥–∏ —Å–∏–¥—è", "sets": "4", "reps": "15‚Äì20", "group": "–°–ø–∏–Ω–∞", "extra": "–¢—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –≤–Ω–∏–∑, –≥—Ä—É–¥—å —á—É—Ç—å –≤—ã–ø—è—á–µ–Ω–∞ –∫ —Ä—É–∫–æ—è—Ç–∏"}, {"title": "–¢—è–≥–∞ –∫ –ø–æ—è—Å—É —Å–∏–¥—è", "sets": "4", "reps": "12‚Äì15", "group": "–°–ø–∏–Ω–∞", "extra": "–¢—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –Ω–∞–∑–∞–¥, –ª–æ–∫—Ç–∏ –Ω–µ –ø—Ä–∏–∂–∞—Ç—ã, –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞ –≤ –ø–æ—è—Å–Ω–∏—Ü–µ"}]}, {"ex": [{"title": "–û—Ç–∂–∏–º–∞–Ω–∏—è", "sets": "4", "reps": "12‚Äì15", "group": "–ì—Ä—É–¥–Ω—ã–µ, —Ç—Ä–∏—Ü–µ–ø—Å", "extra": "–Ø–≥–æ–¥–∏—Ü—ã —Å–∂–∞—Ç—ã, —Ç–∞–∑ –ø–æ–¥–∞–Ω –≤–ø–µ—Ä—ë–¥, –¥–æ –∫–∞—Å–∞–Ω–∏—è –≥—Ä—É–¥—å—é –ø–æ–ª–∞"}, {"title": "–ö—Ä—É–≥–æ–≤—ã–µ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è", "sets": "4", "reps": "15‚Äì20", "group": "–î–µ–ª—å—Ç—ã", "extra": "–õ–∞–¥–æ–Ω–∏ –≤—Å—ë –≤—Ä–µ–º—è —Å–º–æ—Ç—Ä—è—Ç –æ—Ç —Å–µ–±—è"}]}, {"ex": [{"title": "–ü—Ä—è–º—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "sets": "3", "reps": "15‚Äì20", "group": "–ü—Ä–µ—Å—Å"}]}, {"ex": [{"title": "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "sets": "1", "reps": "10:00", "group": "–ö–∞—Ä–¥–∏–æ", "details": "–ó–∞–º–∏–Ω–∫–∞"}]}], "2": [{"ex": [{"title": "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "sets": "1", "reps": "10:00", "group": "–ö–∞—Ä–¥–∏–æ", "details": "–†–∞–∑–º–∏–Ω–∫–∞"}]}, {"ex": [{"title": "–§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∑–∞—à–∞–≥–∏–≤–∞–Ω–∏—è", "sets": "4", "reps": "15/15", "group": "–Ø–≥–æ–¥–∏—á–Ω—ã–µ, –∫–≤–∞–¥—Ä–∏—Ü–µ–ø—Å—ã", "extra": "–ö–æ–ª–µ–Ω–æ –≤–ø–µ—Ä—ë–¥ –Ω–µ —É—Ö–æ–¥–∏—Ç, –Ω–∞–∫–ª–æ–Ω –∫–æ—Ä–ø—É—Å–∞ –∫ –∫–æ–ª–µ–Ω—É"}, {"title": "–ì–∏–ø–µ—Ä—ç–∫—Å—Ç–µ–Ω–∑–∏—è", "sets": "4", "reps": "12‚Äì15", "group": "–°–ø–∏–Ω–∞", "extra": "–ö–æ–ª–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∫–∏ –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É–µ–º, —Å–ø–∏–Ω–∞ –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞"}]}, {"ex": [{"title": "–ì–æ–±–ª–µ—Ç-–ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è", "sets": "4", "reps": "15‚Äì20", "group": "–ö–≤–∞–¥—Ä–∏—Ü–µ–ø—Å—ã, —è–≥–æ–¥–∏—á–Ω—ã–µ", "extra": "–ö–æ–ª–µ–Ω–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤ —Å—Ç–æ—Ä–æ–Ω—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—è—Å–Ω–∏—Ü—ã"}, {"title": "–ú—ë—Ä—Ç–≤–∞—è —Ç—è–≥–∞ –Ω–∞ –æ–¥–Ω–æ–π –Ω–æ–≥–µ", "sets": "4", "reps": "15/15", "group": "–ë—ë–¥—Ä–∞, —è–≥–æ–¥–∏—á–Ω—ã–µ", "extra": "–í –∫–∞–∫–æ–π —Ä—É–∫–µ –≥–∞–Ω—Ç–µ–ª—å, –Ω–∞ —Ç—É –Ω–æ–≥—É –∏ –æ–ø–∏—Ä–∞–µ–º—Å—è"}]}, {"ex": [{"title": "–¢—è–≥–∞ –∫ –ø–æ—è—Å—É —Å—Ç–æ—è", "sets": "4", "reps": "12‚Äì15", "group": "–°–ø–∏–Ω–∞", "extra": "–¢—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –Ω–∞–∑–∞–¥, –ª–æ–∫—Ç–∏ –ø–æ—á—Ç–∏ –ø—Ä–∏–∂–∞—Ç—ã, –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞ –≤ –ø–æ—è—Å–Ω–∏—Ü–µ"}, {"title": "–ü–µ–∫-–¥–µ–∫", "sets": "4", "reps": "24‚Äì30", "group": "–ì—Ä—É–¥–Ω—ã–µ", "extra": "–õ–æ–∫—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–ª–∏ —á—É—Ç—å –Ω–∏–∂–µ –ø–ª–µ—á, —Å–≤–æ–¥–∏–º –∑–∞ —Å—á—ë—Ç –≥—Ä—É–¥–Ω—ã—Ö, –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞"}]}, {"ex": [{"title": "–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è", "sets": "4", "reps": "12‚Äì15", "group": "–°–ø–∏–Ω–∞", "extra": "–¢—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –≤–Ω–∏–∑, –≥—Ä—É–¥—å —á—É—Ç—å –≤—ã–ø—è—á–µ–Ω–∞ –∫ —Ä—É–∫–æ—è—Ç–∫–∞–º"}, {"title": "–ü–æ–¥—ä—ë–º—ã –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π", "sets": "4", "reps": "15‚Äì20", "group": "–î–µ–ª—å—Ç—ã", "extra": "–°–∏–¥–∏–º –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–Ω—è—Ç—å –Ω–æ–≥–∏ –Ω–∞ —Å—Ç–µ–ø"}]}, {"ex": [{"title": "–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ —Å–∫—Ä—É—á–∏–≤–∞–Ω–∏—è", "sets": "3", "reps": "20/20", "group": "–ü—Ä–µ—Å—Å"}]}, {"ex": [{"title": "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "sets": "1", "reps": "10:00", "group": "–ö–∞—Ä–¥–∏–æ", "details": "–ó–∞–º–∏–Ω–∫–∞"}]}], "3": [{"ex": [{"title": "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "sets": "1", "reps": "10:00", "group": "–ö–∞—Ä–¥–∏–æ", "details": "–†–∞–∑–º–∏–Ω–∫–∞"}]}, {"ex": [{"title": "–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ ¬´—Å—É–º–æ¬ª", "sets": "4", "reps": "12‚Äì20", "group": "–ù–æ–≥–∏, —è–≥–æ–¥–∏—Ü—ã", "extra": "–ë–µ–∑ –ø—Ä–æ–≥–∏–±–∞ –≤ –ø–æ—è—Å–Ω–∏—Ü–µ –∏ –±–µ–∑ —Ä—ã–≤–∫–æ–≤"}, {"title": "–ù–∞–∫–ª–æ–Ω—ã —Å –ø–æ–¥—Å–µ–¥–æ–º", "sets": "4", "reps": "25/25", "group": "–ù–æ–≥–∏, —è–≥–æ–¥–∏—Ü—ã", "extra": "–ù–∞–∫–ª–æ–Ω –≥—Ä—É–¥—å—é –∫ –∫–æ–ª–µ–Ω—É, —Å—Ç–æ–ø–æ–π —Ç—è–Ω–µ–º—Å—è –Ω–∞–∑–∞–¥, –±–µ–∑ –ø—Ä–æ–≥–∏–±–∞"}]}, {"ex": [{"title": "–ú—ë—Ä—Ç–≤–∞—è —Ç—è–≥–∞", "sets": "4", "reps": "12‚Äì15", "group": "–°–ø–∏–Ω–∞, –±—ë–¥—Ä–∞", "extra": "–ë–µ–∑ –ø—Ä–æ–≥–∏–±–∞, —Å–ø–∏–Ω–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞, –º–æ–∂–Ω–æ —á—É—Ç—å —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å"}, {"title": "–û—Ç–≤–µ–¥–µ–Ω–∏—è –±–µ–¥—Ä–∞ —Å—Ç–æ—è", "sets": "4", "reps": "20/20", "group": "–Ø–≥–æ–¥–∏—á–Ω—ã–µ", "extra": "–ù–µ—Å–ø–µ—à–∞, –≤—ã—Å–æ–∫–æ –Ω–æ–≥—É –Ω–µ –ø–æ–¥–Ω–∏–º–∞–µ–º"}]}, {"ex": [{"title": "–¢—è–≥–∞ –∫ –≥—Ä—É–¥–∏ —Å–∏–¥—è (—É–∑–∫–∏–π —Ö–≤–∞—Ç)", "sets": "4", "reps": "10+10", "group": "–°–ø–∏–Ω–∞", "extra": "–¢—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –≤–Ω–∏–∑, –∫ –Ω–∏–∑—É –≥—Ä—É–¥–∏, —Å –ø—Ä–æ–≥–∏–±–æ–º"}, {"title": "–û—Ç–≤–µ–¥–µ–Ω–∏—è –ø–ª–µ—á —Å—Ç–æ—è", "sets": "4", "reps": "15‚Äì20", "group": "–î–µ–ª—å—Ç—ã", "extra": "–†—É–∫–∏ –ø–æ—á—Ç–∏ –ø—Ä—è–º—ã–µ, —Ç—è–Ω–µ–º –ª–æ–∫—Ç—è–º–∏ –≤–≤–µ—Ä—Ö, –≥–∞–Ω—Ç–µ–ª–∏ —á—É—Ç—å —Å–ø–µ—Ä–µ–¥–∏"}]}, {"ex": [{"title": "–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π", "sets": "4", "reps": "15/15", "group": "–°–ø–∏–Ω–∞", "extra": "–¢—è–Ω–µ–º –ª–æ–∫—Ç–µ–º –Ω–∞–∑–∞–¥, –¥–≤–∏–∂–µ–Ω–∏–µ –∑–∞ —Å—á—ë—Ç –ª–æ–ø–∞—Ç–∫–∏, –∞ –Ω–µ –±–∏—Ü–µ–ø—Å–∞"}, {"title": "–ñ–∏–º –ª—ë–∂–∞ –ø–æ–¥ —É–≥–ª–æ–º 30¬∞", "sets": "4", "reps": "30", "group": "–ì—Ä—É–¥–Ω—ã–µ, –¥–µ–ª—å—Ç—ã", "extra": "–õ–æ–∫—Ç–∏ –Ω–∞–¥ –ø–ª–µ—á–æ–º, –≤—Å—ë –¥–≤–∏–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫—Ç—è—Ö"}]}, {"ex": [{"title": "–†–æ–ª–ª–µ—Ä –ø—Ä–æ–∫–∞—Ç", "sets": "3", "reps": "20‚Äì30", "group": "–ü—Ä–µ—Å—Å"}]}, {"ex": [{"title": "–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞", "sets": "1", "reps": "10:00", "group": "–ö–∞—Ä–¥–∏–æ", "details": "–ó–∞–º–∏–Ω–∫–∞"}]}]}, "pavel": {"1": [{"ex": [{"title": "(–ø—É—Å—Ç–æ)", "sets": "‚Äî", "reps": "‚Äî", "group": "‚Äî"}]}], "2": [{"ex": [{"title": "(–ø—É—Å—Ç–æ)", "sets": "‚Äî", "reps": "‚Äî", "group": "‚Äî"}]}], "3": [{"ex": [{"title": "(–ø—É—Å—Ç–æ)", "sets": "‚Äî", "reps": "‚Äî", "group": "‚Äî"}]}]}};

// THEME
(function(){
  const root = document.documentElement;
  const saved = localStorage.getItem('app.theme');
  if(saved) root.setAttribute('data-theme', saved);
  const btn = document.getElementById('btnTheme');
  function updateIcon(){
    const cur = root.getAttribute('data-theme') || '';
    btn.textContent = (cur==='light') ? 'üåû' : 'üåô';
    btn.classList.toggle('on', cur==='light');
  }
  updateIcon();
  btn.addEventListener('click', (e)=>{
    e.preventDefault(); e.stopPropagation();
    const cur = root.getAttribute('data-theme');
    const next = cur === 'light' ? 'dark' : 'light';
    root.setAttribute('data-theme', next);
    localStorage.setItem('app.theme', next);
    updateIcon();
  });
})();

let currentPerson = null;
let currentDay = 1;
let pageIndex = 0;
let precomputedLabels = [];
let advanceTimer = null;

function show(id){ document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); }
document.getElementById('btnHistory').addEventListener('click', ()=>{ renderHistory(); show('history'); });
document.getElementById('backHome2').addEventListener('click', ()=> show('home'));

document.getElementById('backHome').addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); show('home'); });
document.getElementById('btnPavel').addEventListener('click', ()=>openPerson('pavel'));
document.getElementById('btnYulia').addEventListener('click', ()=>openPerson('yulia'));
document.getElementById('day1').addEventListener('click', ()=>openDay(1));
document.getElementById('day2').addEventListener('click', ()=>openDay(2));
document.getElementById('day3').addEventListener('click', ()=>openDay(3));
document.getElementById('prevBtn').addEventListener('click', ()=>{pageIndex--;renderPage();});
document.getElementById('nextBtn').addEventListener('click', ()=>{pageIndex++;renderPage();});
document.getElementById('backPerson').addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); show('person'); });
document.getElementById('btnResetDay').addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); resetDay(false); });
document.getElementById('btnFinish').addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); finishDay(); });

function openPerson(p){ currentPerson=p; document.getElementById('personTitle').textContent = p==='yulia'?'–Æ–ª–∏—è':'–ü–∞–≤–µ–ª'; show('person'); }
function openDay(d){
  currentDay=d; pageIndex=0; document.getElementById('dayTitle').textContent='–î–µ–Ω—å '+d;
  const pages = getPages(); let setCount=0, exCount=0;
  precomputedLabels = pages.map((p,idx)=>{ const first = idx===0, last = idx===pages.length-1;
    if(first) return '–†–∞–∑–º–∏–Ω–∫–∞'; if(last) return '–ó–∞–º–∏–Ω–∫–∞';
    if(p.ex && p.ex.length===2) return '–°–µ—Ç ' + (++setCount);
    return '–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ' + (++exCount);
  });
  renderPage(); show('day'); updateTimeLeft();
}
function getPages(){ return programs[currentPerson][currentDay] || []; }
function keyWeight(person, day, page, exIdx){ return `w|${person}|${day}|${page}|${exIdx}`; }
function keySet(person, day, page, exIdx, setIdx){ return `s|${person}|${day}|${page}|${exIdx}|${setIdx}`; }
function parseSets(setsStr){ const m = String(setsStr||'').match(/(\d+)/); return m ? Math.max(1, parseInt(m[1],10)) : 1; }
function needsWeight(title){ const t=String(title).toLowerCase(); if(t.includes('–±–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞')||t.includes('—Å–∫—Ä—É—á–∏–≤')||t.includes('—Ä–æ–ª–ª–µ—Ä')) return false; return true; }
function isWarmup(it){ return /–†–∞–∑–º–∏–Ω–∫–∞/i.test(it.details||''); }
function isCooldown(it){ return /–ó–∞–º–∏–Ω–∫–∞/i.test(it.details||''); }

function renderPage(){
  const pages = getPages(); if(!pages.length) return;
  if(advanceTimer){ clearTimeout(advanceTimer); advanceTimer=null; }
  pageIndex = Math.max(0, Math.min(pageIndex, pages.length-1));
  const page = pages[pageIndex];
  const pagesEl = document.getElementById('pages');
  const blocks = page.ex.map((it, idx)=>{
    const totalSets = parseSets(it.sets);
    let setsHtml = '<div class="sets">';
    for(let s=1;s<=totalSets;s++){ 
      const k = keySet(currentPerson,currentDay,pageIndex,idx,s);
      const checked = localStorage.getItem(k)==='1' ? 'checked' : '';
      setsHtml += '<label class="set"><input type="checkbox" data-k="'+k+'" '+checked+'> –°–µ—Ç '+s+'</label>';
    }
    setsHtml += '</div>';

    let weightHtml = '';
    if(needsWeight(it.title)){
      const wk = keyWeight(currentPerson,currentDay,pageIndex,idx);
      const wv = localStorage.getItem(wk) || '';
      weightHtml = '<div class="weight"><span>–í–µ—Å:</span>'
        + '<input type="text" inputmode="decimal" enterkeyhint="done" pattern="[0-9]*[\.,]?[0-9]*"'
        + ' value="'+wv+'" data-wk="'+wk+'" placeholder="–∫–≥">'
        + '<span class="muted">–∫–≥</span></div>';
    }

    const details = it.details ? ('<div>'+it.details+'</div>') : '';
    const extra = it.extra ? ('<div class="extra">'+it.extra+'</div>') : '';

    return '<div class="ex">'
      + '<h3><span class="dot"></span>'+it.title+'</h3>'
      + '<div class="meta">'
      + '<div>–ü–æ–¥—Ö–æ–¥—ã: <b>'+it.sets+'</b></div>'
      + '<div>–ü–æ–≤—Ç–æ—Ä—ã: <b>'+(it.reps||'-')+'</b></div>'
      + '<div>–ì—Ä—É–ø–ø–∞: <b>'+(it.group||'-')+'</b></div>'
      + details
      + '</div>'
      + extra
      + setsHtml
      + weightHtml
      + '</div>';
  });
  pagesEl.innerHTML = blocks.join('');

  // handlers
  pagesEl.querySelectorAll('input[type="checkbox"]').forEach(cb=>{ 
    cb.addEventListener('change', (e)=> { 
      localStorage.setItem(e.target.dataset.k, e.target.checked?'1':'0'); 
      updateTimeLeft(); 
      scheduleAutoAdvance();
    }); 
  });
  pagesEl.querySelectorAll('.weight input').forEach(inp=>{ inp.addEventListener('change', (e)=> { const v = (e.target.value||'').replace(',', '.').trim(); localStorage.setItem(e.target.dataset.wk, v); }); });

  document.getElementById('counter').textContent = (pageIndex+1)+' / '+pages.length;
  document.getElementById('dayLabel').textContent = precomputedLabels[pageIndex] || '';
  document.getElementById('prevBtn').disabled = (pageIndex===0);
  document.getElementById('nextBtn').disabled = (pageIndex===pages.length-1);
  updateTimeLeft();
}

function scheduleAutoAdvance(){
  if(advanceTimer){ clearTimeout(advanceTimer); advanceTimer=null; }
  const sets = Array.from(document.querySelectorAll('#pages input[type="checkbox"]'));
  if(!sets.length) return;
  const allChecked = sets.every(cb => cb.checked);
  if(allChecked){
    advanceTimer = setTimeout(()=>{
      if(navigator.vibrate) try{ navigator.vibrate(30); }catch(_){}
      const total = getPages().length;
      if(pageIndex < total-1){ pageIndex++; renderPage(); }
    }, 1000);
  }
}

// TIME LEFT
const DUR = { perSet: 2, warmup: 10, cooldown: 10 };
function computeTimeLeft(){
  const pages = getPages(); if(!pages.length) return {total:90, done:0, left:90};
  let totalSets = 0, doneSets = 0, warmupTotal=0, warmupDone=0, cooldownTotal=0, cooldownDone=0;
  for(let p=0;p<pages.length;p++){
    const exs = pages[p].ex || [];
    for(let i=0;i<exs.length;i++){
      const it = exs[i]; const sets = parseSets(it.sets);
      if(isWarmup(it)){
        warmupTotal += DUR.warmup;
        if(localStorage.getItem(keySet(currentPerson,currentDay,p,i,1))==='1') warmupDone += DUR.warmup;
      } else if(isCooldown(it)){
        cooldownTotal += DUR.cooldown;
        if(localStorage.getItem(keySet(currentPerson,currentDay,p,i,1))==='1') cooldownDone += DUR.cooldown;
      } else {
        totalSets += sets;
        for(let s=1;s<=sets;s++){ if(localStorage.getItem(keySet(currentPerson,currentDay,p,i,s))==='1') doneSets++; }
      }
    }
  }
  const total = warmupTotal + cooldownTotal + totalSets * DUR.perSet;
  const done = warmupDone + cooldownDone + doneSets * DUR.perSet;
  return { total: Math.round(total), done: Math.round(done), left: Math.max(0, Math.round(total-done)) };
}
function fmt(mins){ const h=Math.floor(mins/60), m=mins%60; return (h>0? (h+':'+String(m).padStart(2,'0')) : (m+' –º–∏–Ω')); }
function updateTimeLeft(){ const pill=document.getElementById('timeLeftPill'); if(!pill) return; const {left}=computeTimeLeft(); pill.textContent='‚âà '+fmt(left)+' –æ—Å—Ç–∞–ª–æ—Å—å'; }

// RESET & FINISH
function resetDay(skipConfirm){
  if(!skipConfirm){
    const ok = confirm('–°–±—Ä–æ—Å–∏—Ç—å –æ—Ç–º–µ—Ç–∫–∏ –ø–æ–¥—Ö–æ–¥–æ–≤ –∏ –≤–µ—Å–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å?');
    if(!ok) return;
  }
  const pages = getPages();
  for(let p=0;p<pages.length;p++){
    const exs = pages[p].ex || [];
    for(let i=0;i<exs.length;i++){
      const it = exs[i];
      const sets = parseSets(it.sets);
      localStorage.removeItem(keyWeight(currentPerson,currentDay,p,i));
      for(let s=1;s<=sets;s++){ localStorage.removeItem(keySet(currentPerson,currentDay,p,i,s)); }
    }
  }
  renderPage();
  if(!skipConfirm) alert('–ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è –æ—á–∏—â–µ–Ω ‚úÖ');
}
function finishDay(){
  const pages = getPages(); const items=[];
  for(let p=0;p<pages.length;p++){ const exs=pages[p].ex||[]; for(let i=0;i<exs.length;i++){ const it=exs[i]; const sets=parseSets(it.sets);
    let done=0; for(let s=1;s<=sets;s++){ if(localStorage.getItem(keySet(currentPerson,currentDay,p,i,s))==='1') done++; }
    const weight = needsWeight(it.title) ? (localStorage.getItem(keyWeight(currentPerson,currentDay,p,i))||'') : '';
    items.push({title:it.title, sets, done, weight});
  }};
  const entry = {ts:Date.now(), person:currentPerson, day:currentDay, items};
  const arr = JSON.parse(localStorage.getItem('history.v1')||'[]'); arr.unshift(entry); while(arr.length>20) arr.pop();
  localStorage.setItem('history.v1', JSON.stringify(arr));
  resetDay(true);
  alert('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚úÖ');
  show('home');
}

// HISTORY
function renderHistory(){
  const key='history.v1'; const arr = JSON.parse(localStorage.getItem(key) || '[]');
  const list = document.getElementById('historyList'); list.innerHTML='';
  if(!arr.length){ list.innerHTML='<div class="item"><span>–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π. –ù–∞–∂–∏–º–∞–π—Ç–µ ‚úÖ –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.</span></div>'; return; }
  arr.forEach((entry, idx)=>{ const d = new Date(entry.ts);
    const head = d.toLocaleDateString()+' ¬∑ '+(entry.person==='yulia'?'–Æ–ª–∏—è':'–ü–∞–≤–µ–ª')+' ¬∑ –î–µ–Ω—å '+entry.day;
    const summary = entry.items.map(x=>x.title+' ‚Äî '+x.done+'/'+x.sets+(x.weight?(' ¬∑ '+x.weight+' –∫–≥'):'')).slice(0,3).join('; ') + (entry.items.length>3?' ‚Ä¶':'');
    const div = document.createElement('div'); div.className='item';
    const span = document.createElement('span'); span.textContent=head+' ‚Äî '+summary;
    const del = document.createElement('button'); del.textContent='–£–¥–∞–ª–∏—Ç—å'; del.dataset.index=idx;
    del.addEventListener('click', ()=>{ deleteHistory(idx); });
    div.appendChild(span); div.appendChild(del);
    list.appendChild(div);
  });
  const sel = document.getElementById('exerciseSelect'); sel.innerHTML='';
  const names = new Set(); arr.forEach(e=>e.items.forEach(i=>{ if(i.weight) names.add(i.title); }));
  Array.from(names).sort().forEach(n=>{ const opt=document.createElement('option'); opt.value=n; opt.textContent=n; sel.appendChild(opt); });
  sel.onchange = drawChart; drawChart();
}
function deleteHistory(index){
  const key='history.v1'; const arr = JSON.parse(localStorage.getItem(key)||'[]');
  if(index>=0 && index<arr.length){ arr.splice(index,1); localStorage.setItem(key, JSON.stringify(arr)); renderHistory(); }
}
function drawChart(){
  const key='history.v1'; const arr=JSON.parse(localStorage.getItem(key)||'[]');
  const sel = document.getElementById('exerciseSelect'); const name = sel.value || (sel.options[0]?.value || '');
  const data = []; arr.forEach(e=>{ const it = e.items.find(x=>x.title===name); if(it && it.weight){ const y=parseFloat(String(it.weight).replace(',', '.')); if(!isNaN(y)) data.push({x:new Date(e.ts), y}); }});
  const canvas = document.getElementById('chart'); const ctx = canvas.getContext('2d');
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const dpr = window.devicePixelRatio || 1; const w = canvas.clientWidth, h = canvas.clientHeight;
  canvas.width = Math.floor(w*dpr); canvas.height = Math.floor(h*dpr); ctx.scale(dpr,dpr);
  const pad=30; const innerW=w-pad*2, innerH=h-pad*2; ctx.save(); ctx.translate(pad,pad);
  ctx.strokeStyle='rgba(0,0,0,0.15)';
  for(let i=0;i<=4;i++){ const y=i*innerH/4; ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(innerW,y); ctx.stroke(); }
  if(data.length){ const xs=data.map(d=>d.x.getTime()); const ys=data.map(d=>d.y);
    const minX=Math.min(...xs), maxX=Math.max(...xs)||1; const minY=Math.min(...ys), maxY=Math.max(...ys)||1;
    const tx=v=> innerW*(v-minX)/((maxX-minX)||1); const ty=v=> innerH - innerH*(v-minY)/((maxY-minY)||1);
    ctx.lineWidth=2; ctx.strokeStyle='rgba(219,39,119,0.95)'; ctx.beginPath();
    data.sort((a,b)=>a.x-b.x).forEach((d,i)=>{ const X=tx(d.x.getTime()), Y=ty(d.y); if(i) ctx.lineTo(X,Y); else ctx.moveTo(X,Y); });
    ctx.stroke(); ctx.fillStyle='rgba(34,197,94,0.95)';
    data.forEach(d=>{ const X=tx(d.x.getTime()), Y=ty(d.y); ctx.beginPath(); ctx.arc(X,Y,3,0,Math.PI*2); ctx.fill(); });
  } else { ctx.fillStyle='rgba(0,0,0,0.5)'; ctx.fillText('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤–µ—Å–∞–º', 10, 20); }
  ctx.restore();
}
</script>


</body></html>
